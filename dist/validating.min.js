(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var OBLIGATIONS=require("obligations");"use strict";exports.Validator=require("./validator");exports.validators=Object.create(null);exports.define=function(name,descriptors){if(typeof descriptors==="function"){exports.validators[name]=descriptors}else{exports.validators[name]=exports.Validator.extend(descriptors)}return exports.validators[name]};exports.create=function(name,properties){return exports.validators[name].create(properties)};exports.forDescriptors=function(descriptors){OBLIGATIONS.precondition(descriptors&&typeof descriptors==="object","Descriptors must be an object.");var __result;var names=Object.keys(descriptors),total=names.length,validators=[],lines=[],descriptor,name,items,i,accessor;for(i=0;i<total;i++){name=names[i];descriptor=descriptors[name];if(/^([\w|_|$]+)$/.test(name)){accessor="."+name}else{accessor='["'+name+'"]'}if(descriptor.rules){items=descriptor.rules.map(processRule).map(function(validator){var index=validators.push(validator)-1;return"if ((result = validators["+index+"].validate(obj"+accessor+")) !== true) {\n"+"  isValid = false;\n"+"  errors"+accessor+" = result;\n"+"}\n"});lines.push(items.join("else "))}}var body="var isValid = true,\n"+"    errors = {},\n"+"    result;\n\n"+lines.join("\n")+"\n"+"return {valid: isValid, errors: errors};";var fn=new Function("validators","obj",body);__result=fn.bind(undefined,validators);OBLIGATIONS.postcondition(typeof __result==="function");return __result};function processRule(rule){if(typeof rule!=="function"){OBLIGATIONS.precondition(Array.isArray(rule)&&rule[0]||rule.name,"Validator name must be specified.")}var __result;main:{if(typeof rule==="function"){__result=new exports.Validator({validate:rule});break main}else if(Array.isArray(rule)){__result=exports.create.apply(exports,rule);break main}else{__result=exports.create(rule.name,rule);break main}}OBLIGATIONS.postcondition(__result instanceof exports.Validator);return __result}var validators=require("./validators"),names=Object.keys(validators),total=names.length,name,i;for(i=0;i<total;i++){name=names[i];exports.define(name,validators[name])}},{"./validator":2,"./validators":3,obligations:5}],2:[function(require,module,exports){var OBLIGATIONS=require("obligations");"use strict";var Class=require("classing");module.exports=Class.create({messages:{"default":function(){return{"default":"Invalid value."}}},message:{get:function(){return this.messages.default},set:function(value){this.messages.default=value}},allowEmpty:{value:false},isEmpty:function(value){if(value==null||value===""){return true}else if(Array.isArray(value)&&value.length===0){return true}else if(typeof value==="object"&&Object.keys(value).length===0){return true}else{return false}},prepare:function(message,references){OBLIGATIONS.precondition(typeof message==="string","Message must be a string.");if(references){OBLIGATIONS.precondition(typeof references==="object","References must be an object.")}references=references||this;return message.replace(/\{\{(\w+)\}\}/g,function(token,item){return references[item]||""})},validate:function(value){return true}})},{classing:4,obligations:5}],3:[function(require,module,exports){var OBLIGATIONS=require("obligations");"use strict";exports.required={messages:{"default":function(){return{"default":"Cannot be empty."}}},validate:function(value){if(this.isEmpty(value)){return this.prepare(this.message)}else{return true}}};exports.type={messages:{"default":function(){return{"default":"Expected {{expected}}, got {{got}}."}}},type:{value:"string"},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}var expected=this.type,got=typeof value;if(expected==="null"&&value===null){return true}else if(expected===got){return true}else{return this.prepare(this.message,{got:got,expected:expected})}}};exports.instanceOf={messages:{"default":function(){return{"default":"Expected {{expected}}, got {{got}}."}}},"class":{},className:{get:function(){OBLIGATIONS.precondition(this.class,"Class must be specified");OBLIGATIONS.precondition(typeof this.class==="string"||typeof this.class==="function","Class must be a string or a function.");return typeof this.class==="string"?this.class:this.class.name}},validate:function(value){OBLIGATIONS.precondition(this.class,"Class must be specified");OBLIGATIONS.precondition(typeof this.class==="string"||typeof this.class==="function","Class must be a string or a function.");if(this.allowEmpty&&this.isEmpty(value)){return true}var className=this.className,references;if(!value||typeof value!=="object"||!value.constructor){references={expected:className,got:value===null?"null":typeof value}}else{if(typeof this.class==="function"){if(value instanceof this.class){return true}}else if(value.constructor.name===className){return true}references={expected:className,got:value.constructor.name}}return this.prepare(this.message,references)}};exports.length={messages:{"default":function(){return{invalid:"The value is invalid.",tooShortString:"Too short, should be at least {{min}} character(s).",tooLongString:"Too long, should be at most {{max}} character(s).",tooShortArray:"Too short, should contain at least {{min}} item(s).",tooLongArray:"Too long, should contain at most {{max}} item(s).",tooShortObject:"Too short, should contain at least {{min}} key(s).",tooLongObject:"Too long, should contain at most {{max}} key(s)."}}},min:{},max:{},validate:function(value){OBLIGATIONS.precondition(this.min||this.max,"No constraints specified for length validator.");if(this.allowEmpty&&this.isEmpty(value)){return true}else if(typeof value==="string"){return this.validateString(value)}else if(Array.isArray(value)){return this.validateArray(value)}else if(value&&typeof value==="object"){return this.validateObject(value)}else{return this.prepare(this.messages.invalid)}},validateString:function(value){OBLIGATIONS.precondition(typeof value==="string","Value must be a string.");if(this.min&&value.length<this.min){return this.prepare(this.messages.tooShortString)}else if(this.max&&value.length>this.max){return this.prepare(this.messages.tooLongString)}else{return true}},validateArray:function(value){OBLIGATIONS.precondition(Array.isArray(value),"Value must be an array.");if(this.min&&value.length<this.min){return this.prepare(this.messages.tooShortArray)}else if(this.max&&value.length>this.max){return this.prepare(this.messages.tooLongArray)}else{return true}},validateObject:function(value){OBLIGATIONS.precondition(value&&typeof value==="object","Value must be an object.");var keys=Object.keys(value);if(this.min&&keys.length<this.min){return this.prepare(this.messages.tooShortObject)}else if(this.max&&keys.length>this.max){return this.prepare(this.messages.tooLongObject)}else{return true}}};exports.number={messages:{"default":function(){return{invalid:"Expected a number.",tooSmall:"Must be at least {{min}}.",tooLarge:"Must be at most {{max}}."}}},min:{},max:{},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(typeof value!=="number"){return this.prepare(this.messages.invalid)}else if(this.min&&value<this.min){return this.prepare(this.messages.tooSmall)}else if(this.max&&value>this.max){return this.prepare(this.messages.tooLarge)}else{return true}}};exports.boolean={messages:{"default":function(){return{"default":"Must be true or false."}}},trueValues:{"default":function(){return[true]}},falseValues:{"default":function(){return[false]}},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(~this.trueValues.indexOf(value)){return true}else if(~this.falseValues.indexOf(value)){return true}else{return this.prepare(this.message)}}};exports.regexp={messages:{"default":function(){return{"default":"Does not match the required pattern.",badType:"Should be a text value."}}},pattern:{get:function(){return this._pattern||new RegExp},set:function(value){if(typeof value==="string"){value=new RegExp(value)}this._pattern=value}},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(typeof value!=="string"){return this.prepare(this.messages.badType)}else if(this.pattern.test(value)){return true}else{return this.prepare(this.message)}}};exports.url={messages:{"default":function(){return{"default":"Not a valid URL."}}},schemes:{"default":function(){return["http","https"]}},strict:{value:true},pattern:{get:function(){if(!this._pattern){this._pattern=this.createPattern()}return this._pattern},set:function(value){if(typeof value==="string"){value=new RegExp(value,"i")}this._pattern=value}},createPattern:function(){var pattern="^(({schemes}):\\/\\/)?(([A-Z0-9][A-Z0-9_-]*)(\\.[A-Z0-9][A-Z0-9_-]*)+)".replace("{schemes}",this.schemes.join("|"));return new RegExp(pattern,"i")},validate:function(value){var matches;if(this.allowEmpty&&this.isEmpty(value)){return true}else if(!(matches=this.pattern.exec(value))){return this.prepare(this.message)}if(this.strict&&!matches[1]){return this.prepare(this.message)}else{return true}}};exports.email={messages:{"default":function(){return{"default":"Not a valid email address."}}},pattern:{value:/@(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)$/i},validate:function(value){if(this.allowEmpty&&this.isEmpty(value)){return true}else if(this.pattern.test(value)){return true}else{return this.prepare(this.message)}}}},{obligations:5}],4:[function(require,module,exports){"use strict";function Classing(name,descriptors){return Classing.create(name,descriptors)}module.exports=exports=Classing;Classing.create=function(name,descriptors){if(name&&typeof name==="string"){descriptors=descriptors||{}}else{descriptors=name||{};name="Class"}var Class=this.makeConstructor(name);this.makeStatic(Class,descriptors);this.makePrototype(Class,descriptors);return Class};Classing.makeConstructor=function(name){var body="return function "+name+" (config) {"+"  if (!(this instanceof "+name+")) {"+"    return new "+name+"(config);"+"  }"+"  this.applyDefaults();"+"  if (config) { this.configure(config); }"+"  this.initialize();"+"};";return new Function(body)()};Classing.makeStatic=function(Class,descriptors){var Classing=this;Object.defineProperties(Class,{create:{configurable:true,value:function(properties){return new Class(properties)}},descriptors:{value:descriptors},defineProperty:{configurable:true,value:function(name,descriptor,skipReload){descriptor=descriptor||{value:null};if(typeof descriptor==="function"){descriptor={enumerable:false,configurable:true,writable:true,value:descriptor}}if(descriptor.value===undefined&&!(descriptor.get||descriptor.set)){descriptor.value=null}if(descriptor.writable==null&&descriptor.value!==undefined){descriptor.writable=true}if(descriptor.enumerable==null){descriptor.enumerable=true}if(descriptor.configurable==null){descriptor.configurable=true}descriptors[name]=descriptor;Object.defineProperty(this.prototype,name,descriptor);if(!skipReload){if(!this.prototype.applyDefaults||this.prototype.applyDefaults.isAutoGenerated){this.prototype.applyDefaults=this.makeApplyDefaults(descriptors)}if(!this.prototype.configure||this.prototype.configure.isAutoGenerated){this.prototype.configure=this.makeConfigure(descriptors)}if(!this.prototype.toJSON||this.prototype.toJSON.isAutoGenerated){this.prototype.toJSON=this.makeToJSON(descriptors)}}return this}},defineProperties:{configurable:true,value:function(items){if(!items){return this}var keys=Object.keys(items),total=keys.length,key,i;for(i=0;i<total;i++){key=keys[i];this.defineProperty(key,items[key],true)}if(!this.prototype.applyDefaults||this.prototype.applyDefaults.isAutoGenerated){this.prototype.applyDefaults=this.makeApplyDefaults(descriptors)}if(!this.prototype.configure||this.prototype.configure.isAutoGenerated){this.prototype.configure=this.makeConfigure(descriptors)}if(!this.prototype.toJSON||this.prototype.toJSON.isAutoGenerated){this.prototype.toJSON=this.makeToJSON(descriptors)}return this}},inherits:{configurable:true,value:function(Super){var keys=Object.keys(Super),total=keys.length,key,i;for(i=0;i<total;i++){key=keys[i];if(!this.hasOwnProperty(key)){this[key]=Super[key]}}var superDescriptors=Super.descriptors||{};keys=Object.keys(superDescriptors);total=keys.length;for(i=0;i<total;i++){key=keys[i];if(!descriptors.hasOwnProperty(key)){descriptors[key]=superDescriptors[key]}}descriptors.super={enumerable:false,value:Super.prototype};this.prototype=Object.create(Super.prototype,descriptors);this.prototype.constructor=this;if(!this.prototype.toString||this.prototype.toString.isAutoGenerated){this.prototype.toString=this.makeToString(descriptors)}if(!this.prototype.applyDefaults||this.prototype.applyDefaults.isAutoGenerated){this.prototype.applyDefaults=this.makeApplyDefaults(descriptors)}if(!this.prototype.configure||this.prototype.configure.isAutoGenerated){this.prototype.configure=this.makeConfigure(descriptors)}if(!this.prototype.toJSON||this.prototype.toJSON.isAutoGenerated){this.prototype.toJSON=this.makeToJSON(descriptors)}return this}},extend:{configurable:true,value:function(config){var Child=Classing.create(config);Child.inherits(this);return Child}},mixin:{configurable:true,value:function(source){var keys=Object.keys(source),total=keys.length,combined={},key,i;for(i=0;i<total;i++){key=keys[i];combined[key]={value:source[key]}}this.defineProperties(combined);return this}},makeApplyDefaults:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,body="",key,descriptor,i,suffix,value;for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(descriptor.hasOwnProperty("default")){suffix="";if(typeof descriptor.default==="function"){suffix="(this)"}if(/^([\w|_|$]+)$/.test(key)){body+="this."+key+" = this.constructor.descriptors."+key+".default"+suffix+";"}else{body+='this["'+key+'"] = this.constructor.descriptors["'+key+'"].default'+suffix+";"}}else if(descriptor.bind){if(/^([\w|_|$]+)$/.test(key)){if(descriptor.bind===true){value="this"}else{value="this.constructor.descriptors."+key+".bind"}body+="this."+key+" = this."+key+".bind("+value+");"}else{if(descriptor.bind===true){value="this"}else{value='this.constructor.descriptors["'+key+'"].bind'}body+='this["'+key+'"] = this["'+key+'"].bind('+value+");"}}}var applyDefaults=new Function(body);applyDefaults.isAutoGenerated=true;return applyDefaults}},makeConfigure:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,body="",key,descriptor,i;for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(descriptor.writable||descriptor.hasOwnProperty("set")){if(/^([\w|_|$]+)$/.test(key)){body+="this."+key+" = config."+key+" !== undefined ? config."+key+" : this."+key+";"}else{body+='this["'+key+'"] = config["'+key+'"] !== undefined ? config["'+key+'"] : this["'+key+'"];'}}}var configure=new Function("config",body);configure.isAutoGenerated=true;return configure}},makeToJSON:{configurable:true,value:function(descriptors){var keys=Object.keys(descriptors),total=keys.length,parts=[],key,descriptor,i;for(i=0;i<total;i++){key=keys[i];descriptor=descriptors[key];if(descriptor.enumerable||descriptor.enumerable==null){if(/^([\w|_|$]+)$/.test(key)){parts.push(key+": this."+key)}else{parts.push('"'+key+'": this["'+key+'"]')}}}var toJSON=new Function("return {"+parts.join(",")+"};");toJSON.isAutoGenerated=true;return toJSON}},makeToString:{configurable:true,value:function(){var fn=new Function('return "[object '+this.name+']";');fn.isAutoGenerated=true;return fn}}})};Classing.makePrototype=function(Class,descriptors){Class.defineProperties(descriptors);if(!descriptors.initialize){Class.defineProperty("initialize",function(){})}if(!descriptors.hasOwnProperty("toString")){Object.defineProperty(Class.prototype,"toString",{configurable:true,writable:true,value:Class.makeToString(descriptors)})}if(!descriptors.hasOwnProperty("applyDefaults")){Object.defineProperty(Class.prototype,"applyDefaults",{configurable:true,writable:true,value:Class.makeApplyDefaults(descriptors)})}if(!descriptors.hasOwnProperty("configure")){Object.defineProperty(Class.prototype,"configure",{configurable:true,writable:true,value:Class.makeConfigure(descriptors)})}if(!descriptors.hasOwnProperty("toJSON")){Object.defineProperty(Class.prototype,"toJSON",{configurable:true,writable:true,value:Class.makeToJSON(descriptors)})}};Classing.extend=function(descriptors){descriptors=descriptors||{};function Child(descriptors){return Child.create(descriptors)}var keys=Object.keys(this),total=keys.length,i,key;for(i=0;i<total;i++){key=keys[i];Child[key]=this[key]}keys=Object.keys(descriptors);total=keys.length;for(i=0;i<total;i++){key=keys[i];if(typeof descriptors[key]==="function"){descriptors[key]={configurable:true,value:descriptors[key]}}}Object.defineProperties(Child,descriptors);Child.super=this;return Child}},{}],5:[function(require,module,exports){function PreconditionError(message,caller){this.name="PreconditionError";this.message=message||"Precondition failed";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,caller||PreconditionError)}}PreconditionError.prototype=Object.create(Error.prototype);PreconditionError.prototype.constructor=PreconditionError;function PostconditionError(message,caller){this.name="PostconditionError";this.message=message||"Postcondition failed";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,caller||PreconditionError)}}PostconditionError.prototype=Object.create(Error.prototype);PostconditionError.prototype.constructor=PreconditionError;function InvariantError(message,caller){this.name="InvariantError";this.message=message||"Invariant failed";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,caller||InvariantError)}}InvariantError.prototype=Object.create(Error.prototype);InvariantError.prototype.constructor=InvariantError;function precondition(subject,message){if(!subject){throw new PreconditionError(message,precondition)}}function postcondition(subject,message){if(!subject){throw new PostconditionError(message,postcondition)}}function invariant(subject,message){if(!subject){throw new InvariantError(message,invariant)}}exports.PreconditionError=PreconditionError;exports.PostconditionError=PostconditionError;exports.InvariantError=InvariantError;exports.precondition=precondition;exports.postcondition=postcondition;exports.invariant=invariant},{}]},{},[1]);